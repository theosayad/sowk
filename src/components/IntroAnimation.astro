---
/* IntroAnimation component */
---
<style>
    /* ensure the page is pure white behind your PNGs */
    html, body {
      margin: 0;
      background: #ffffff;
    }

  .stopmotion-intro {
    position: fixed; inset: 0;
    /* was: background: #f8f9fa; */
    background: #ffffff;    /* ← pure white */
    display: flex; flex-direction: column;
    align-items: center; gap: 1.5rem;
    padding: 2rem 1rem 1rem;
    overflow: hidden; z-index: 1000;
    box-sizing: border-box;
  }

  /* ────────── container & layout ────────── */
  .stopmotion-intro {
    position: fixed; inset: 0;
    background: #f8f9fa;
    display: flex; flex-direction: column;
    align-items: center; gap: 1.5rem;
    padding: 2rem 1rem 1rem;
    overflow: hidden; z-index: 1000;
    box-sizing: border-box;
  }

  /* ────────── header image ────────── */
  .header-img {
    width: 80%;               /* default width */
    max-width: 600px;         /* never exceed */
    height: auto;
    display: block;
    z-index: 2;
  }

  /* ────────── stop-motion truck ────────── */
  .sm-container {
    position: relative;
    width: 90%;
    max-width: 500px;
    overflow: hidden;
    z-index: 1;
  }
  .sm-img {
    display: block;
    width: 100%;
    transform: translateX(-120%);
  }
  .sm-img.drive-in {
    transition: transform 2s ease-out;
    transform: translateX(0);
  }
  .sm-img.drive-out {
    transition: transform 2s ease-in;
    transform: translateX(120%);
  }

  /* ────────── fade-out ────────── */
  .stopmotion-intro.fade-out {
    animation: fadeOut 1s ease-out forwards;
  }
  @keyframes fadeOut {
    to { opacity: 0; pointer-events: none; }
  }

  /* ────────── responsiveness ────────── */
  @media (max-width: 600px) {
    .header-img { width: 90%; }
    .sm-container { width: 95%; max-width: none; }
  }
</style>

<div class="stopmotion-intro" id="intro">
  <!-- 1️⃣ Hand-drawn header -->
  <img
    id="headerImg"
    class="header-img"
    src="/images/header%20text.png"
    alt="Hi! Please drop off all your WORRIES before entering"
  />

  <!-- 2️⃣ Stop-motion truck -->
  <div class="sm-container">
    <img
      id="smImg"
      class="sm-img"
      src="/images/truck.png"
      alt="hand-drawn dump truck"
    />
  </div>
</div>

<script type="module">
  document.addEventListener('DOMContentLoaded', () => {
    const intro = document.getElementById('intro');
    const smImg = document.getElementById('smImg');

    // only once per session
    if (sessionStorage.getItem('introPlayed')) {
      intro.remove();
      return;
    }
    sessionStorage.setItem('introPlayed','true');

    // drive in after header shows (0.5s)
    setTimeout(() => smImg.classList.add('drive-in'), 500);

    // after drive-in (2s) + pause (0.3s), swap drop frames
    const dropFrames = [
      '/images/worries%20falling%20into%20truck.png',
      '/images/worries%20falling%20into%20truck-2.png',
      '/images/truck%20with%20worries.png'
    ];
    const initialDelay = 500 + 2000 + 300;

    setTimeout(() => {
      dropFrames.forEach((src, i) => {
        setTimeout(() => smImg.src = src, i * 800);
      });

      // after drops (n*0.8s) + 1s pause, drive out
      const totalDrops = dropFrames.length * 800;
      setTimeout(() => {
        smImg.classList.add('drive-out');

        // fade out 2s after drive-out begins
        setTimeout(() => {
          intro.classList.add('fade-out');
          setTimeout(() => intro.remove(), 1000);
        }, 2000);
      }, totalDrops + 1000);
    }, initialDelay);
  });
</script>


