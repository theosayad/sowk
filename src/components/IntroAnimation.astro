---
/* IntroAnimation – stop-motion with your hand-drawn art */
---
<style>
  /* ────────── container & layering ────────── */
  .stopmotion-intro {
    position: fixed; inset: 0;
    background: #f8f9fa;
    display: flex;
    flex-direction: column;
    align-items: center;
    gap: 1.5rem;
    padding-top: 2rem;
    overflow: hidden;
    z-index: 1000;
    font-family: 'Comic Sans MS', cursive;
  }

  /* ────────── header image ────────── */
  .header-img {
    max-width: 90%;
    height: auto;
    display: block;
    z-index: 2;
  }

  /* ────────── stop-motion truck ────────── */
  .sm-container {
    position: relative;
    width: 500px;
    height: auto;
    overflow: hidden;
    z-index: 1;
  }
  .sm-img {
    display: block;
    width: 100%;
    transform: translateX(-100%);
  }
  .sm-img.drive-in {
    transition: transform 2s ease-out;
    transform: translateX(0);
  }
  .sm-img.drive-out {
    transition: transform 2s ease-in;
    transform: translateX(100%);
  }

  /* ────────── fade-out ────────── */
  .stopmotion-intro.fade-out {
    animation: fadeOut 1s ease-out forwards;
  }
  @keyframes fadeOut {
    to { opacity: 0; pointer-events: none; }
  }
</style>

<div class="stopmotion-intro" id="intro">
  <!-- 1️⃣ Your hand-drawn header -->
  <img
    id="headerImg"
    class="header-img"
    src="/images/intro/header text.png"
    alt="Hi! Please drop off all your WORRIES before entering"
  />

  <!-- 2️⃣ Stop-motion truck sequence -->
  <div class="sm-container">
    <img
      id="smImg"
      class="sm-img"
      src="/images/intro/truck.png"
      alt="hand-drawn dump truck"
    />
  </div>
</div>

<script type="module">
  document.addEventListener('DOMContentLoaded', () => {
    const intro = document.getElementById('intro');
    const smImg = document.getElementById('smImg');

    // Only show once per session
    if (sessionStorage.getItem('introPlayed')) {
      intro.remove();
      return;
    }
    sessionStorage.setItem('introPlayed','true');

    // 1️⃣ Drive the blank truck in after 0.5s
    setTimeout(() => {
      smImg.classList.add('drive-in');
    }, 500);

    // 2️⃣ After drive-in (2s) + small pause, play drop frames
    const dropFrames = [
      '/images/intro/worries falling into truck.png',
      '/images/intro/worries falling into truck-2.png',
      '/images/intro/truck with worries.png'
    ];
    const driveInDuration = 2000;
    const pauseAfterDriveIn = 300; // ms

    setTimeout(() => {
      dropFrames.forEach((src, idx) => {
        setTimeout(() => {
          smImg.src = src;
        }, idx * 800);
      });

      // 3️⃣ After all drops + 1s pause, drive out
      const totalDropTime = dropFrames.length * 800; // e.g. 3*800=2400
      setTimeout(() => {
        smImg.classList.add('drive-out');

        // 4️⃣ Fade out intro 2s after drive-out starts
        setTimeout(() => {
          intro.classList.add('fade-out');
          setTimeout(() => intro.remove(), 1000);
        }, 2000);

      }, totalDropTime + 1000);

    }, 500 + driveInDuration + pauseAfterDriveIn);

  });
</script>
