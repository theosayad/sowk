---
import Layout from '../layouts/Default.astro';
import activities from '../data/activities.json' assert { type: 'json' };

/* remove empty / undefined categories */
const categories = [
  ...new Set(activities.map(a => a.category).filter(Boolean))
];
---

<Layout title="Experience · SOWK">
  <section class="experience-hero">
    <h1>Things to do in &amp; around Smar Jbeil</h1>
  </section>

{categories.map(cat => (
  /*  Mobile (<640 px)  → collapsible “accordion”
      Desktop         → always open, behaves exactly like before  */
  <details class="experience-section" open>
    <summary class="experience-category">{cat}</summary>

    <div class="experience-grid">
      {activities
        .filter(a => a.category === cat)
        .map(a => (
          <article class="experience-card">
            <img
              src={a.image}
              alt={a.name}
              class="experience-thumb"
              loading="lazy"
              width="400"
              height="260"
            />

            <div class="experience-body">
              <h3>{a.name}</h3>
              <p class="experience-meta">
                {a.location} · {a.distance.toFixed(1)} km
              </p>
              <p class="experience-desc">{a.description}</p>

              <a href={`/experience/${a.slug}`} class="experience-link">
                More&nbsp;info&nbsp;↗
              </a>
            </div>
          </article>
        ))}
    </div>
  </details>
))}

</Layout>

<style>
/* ========== typography – force Poppins everywhere ========== */
body, h1, h2, h3, p, a { font-family:'Poppins', sans-serif; }

/* ---------- hero ---------- */
.experience-hero      { text-align:center; margin:4rem 0 2rem; }
.experience-hero h1   { font-size:2.4rem; font-weight:700; }

/* ---------- category heading ---------- */
.experience-category  { font-size:1.75rem; margin:3.5rem 0 1.5rem;
                        color:#294534; font-weight:600; }

/* ---------- responsive grid ---------- */
.experience-grid      { display:grid; gap:2rem;
                        grid-template-columns:repeat(auto-fit,minmax(320px,1fr)); }

/* ---------- card ---------- */
.experience-card      { background:#fff; border-radius:1rem; overflow:hidden;
                        box-shadow:0 18px 48px rgba(0,0,0,.05);
                        display:flex; flex-direction:column; }
.experience-thumb     { width:100%; height:200px; object-fit:cover; }

.experience-body      { padding:1.5rem; display:flex; flex-direction:column; gap:0.75rem; }
.experience-body h3   { font-size:1.25rem; font-weight:600; }

.experience-meta      { font-size:.9rem; color:#667; }
.experience-desc      { font-size:.95rem; line-height:1.6; }

.experience-link      { margin-top:auto; font-weight:600; color:#c89a2a;
                        text-decoration:none; }
.experience-link:hover{ text-decoration:underline; }

/* ────────── extra horizontal breathing-room ────────── */
.experience-grid     { padding-inline: 1rem; }   /* both mobile & desktop */
@media (min-width: 640px){                       /* ≥640 px keeps previous look */
  .experience-grid { padding-inline: 0; }
}

/* ────────── accordion behaviour on phones ────────── */
.experience-section           { border: none; margin: 0 0 2rem; }
.experience-section summary   { list-style:none; cursor:pointer; }
.experience-section summary::-webkit-details-marker{ display:none; }

/* nicer arrow  */
.experience-section summary::after{
  content:"▾"; font-size:1rem; margin-left:.4rem; transition:.2s;
}
.experience-section[open] summary::after{ transform:rotate(180deg); }

/* desktop: keep all sections open & hide arrow */
@media (min-width:640px){
  .experience-section         { display:block; }
  .experience-section summary::after{ display:none; }
  .experience-section[open] summary::after{ display:none; }
  .experience-section[open] > .experience-grid{ display:grid; }
}

</style>
