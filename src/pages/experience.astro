---
import Layout from '../layouts/Default.astro';
import activities from '../data/activities.json' assert { type: 'json' };

/* remove empty / undefined categories */
const categories = [
  ...new Set(activities.map(a => a.category).filter(Boolean))
];
---

<Layout title="Experience · SOWK">
  <section class="experience-hero">
    <h1>Things to do in &amp; around Smar Jbeil</h1>
  </section>

{categories.map(cat => {
  /* build a URL-safe slug for the category itself */
  const catSlug = cat.toLowerCase().replace(/[^a-z0-9]+/g, '-').replace(/^-|-$/g, '');
  return (
    <>
      <h2 class="experience-category">
        <a href={`/experience/category/${catSlug}`} class="experience-catlink">{cat}</a>
      </h2>

      {/* horizontally scrollable strip (≈ 2–3 cards visible) */}
      <div class="experience-strip" role="list">
        {activities
          .filter(a => a.category === cat)
          .map(a => (
            <article class="experience-card horizontal" role="listitem">
              <img
                src={a.image}
                alt={a.name}
                class="experience-thumb"
                loading="lazy"
                width="320"
                height="200"
              />

              <div class="experience-body">
                <h3>{a.name}</h3>
                <p class="experience-meta">
                  {a.location} · {a.distance.toFixed(1)} km
                </p>
                <p class="experience-desc">{a.description}</p>

                <a href={`/experience/${a.slug}`} class="experience-link">
                  More&nbsp;info&nbsp;↗
                </a>
              </div>
            </article>
        ))}
      </div>
    </>
  );
})}

</Layout>

<style>
/* ========== typography – force Poppins everywhere ========== */
body, h1, h2, h3, p, a { font-family:'Poppins', sans-serif; }

/* ---------- hero ---------- */
.experience-hero      { text-align:center; margin:4rem 0 2rem; }
.experience-hero h1   { font-size:2.4rem; font-weight:700; }

/* ───────── category heading ───────── */
.experience-category   { padding-left: 1rem; margin-top: 3rem; }
.experience-catlink    { color: inherit; text-decoration: none; }
.experience-catlink:hover { text-decoration: underline; }

/* ───────── horizontal strip ───────── */
.experience-strip {
  display: flex;
  gap: 1rem;
  overflow-x: auto;
  scroll-snap-type: x mandatory;
  padding-inline: 1rem;
  scroll-padding-inline: 1rem;
}
.experience-strip::-webkit-scrollbar { display:none; }
.experience-strip { scrollbar-width:none; }

/* ───────── compact card ───────── */
.experience-card.horizontal {
  min-width: 190px;          /* ≈ 2½ cards on a phone */
  flex: 0 0 auto;
  scroll-snap-align: start;
  border-radius: .75rem;
}
.experience-thumb           { width:100%; height:130px; object-fit:cover; }

.experience-body            { padding:1rem; gap:.5rem; }
.experience-body h3         { font-size:1rem; line-height:1.3; }
.experience-meta            { font-size:.8rem; }
.experience-desc            { font-size:.85rem; }

@media (min-width:640px){                 /* tablets / desktop */
  .experience-card.horizontal{ min-width:250px; }
  .experience-thumb{ height:160px; }
  .experience-body h3{ font-size:1.15rem; }
}

</style>
