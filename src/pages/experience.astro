---
// src/pages/experience.astro

import Layout from '../layouts/Default.astro';
import activities from '../data/activities.json' assert { type: 'json' };

// all unique, non‐empty categories
const categories = [
  ...new Set(activities.map((a) => a.category).filter(Boolean))
];

// helper to turn “My Category” → “my-category” for IDs
const slugify = (s: string) =>
  s.toLowerCase().replace(/[^a-z0-9]+/g, '-').replace(/(^-|-$)/g, '');
---

<Layout title="Experience · SOWK">
  <section class="experience-hero">
    <h1>Things to do in &amp; around Smar Jbeil</h1>
  </section>

  {categories.map((cat) => {
    const id = slugify(cat);
    return (
      <details class="category-section" open>
        <summary id={id} class="experience-category">{cat}</summary>
        <div class="experience-row">
          {activities
            .filter((a) => a.category === cat)
            .map((a) => (
              <a href={`/experience/${a.slug}`} class="experience-card">
                <img
                  src={a.image || '/images/placeholder.jpg'}
                  alt={a.name}
                  class="experience-thumb"
                  loading="lazy"
                  width="300"
                  height="200"
                />
                <h3>{a.name}</h3>
                <p class="experience-meta">{a.distance.toFixed(1)} km away</p>
                <span class="experience-link">More info ↗</span>
              </a>
          ))}
        </div>
      </details>
    );
  })}
</Layout>

<style>
  /* force Poppins */
  body, h1, h3, p, a { font-family:'Poppins',sans-serif; }

  .experience-hero {
    text-align:center;
    margin:4rem 0 2rem;
  }
  .experience-hero h1 {
    font-size:2.4rem;
    font-weight:700;
    line-height:1.2;
  }

  /* details/summary styles */
  .category-section {
    margin-bottom:2rem;
  }
  .experience-category {
    cursor:pointer;
    font-size:1.5rem;
    font-weight:600;
    padding:0.5rem 2rem;
    color:#294534;
    list-style:none;
  }
  /* hide default arrow, use our own if you like */
  .experience-category::-webkit-details-marker { display:none; }

  /* ─── horizontal swipe row ─── */
  .experience-row {
    display: flex;
    gap: 1rem;
    overflow-x: auto;
    scroll-snap-type: x mandatory;
  
    /* keep your overall top/right/bottom padding */
    padding: 1rem 2rem 1.5rem;
  
    /* ensure every snap-stop sits 2rem from *either* edge */
    scroll-padding-inline-start: 2rem;
    scroll-padding-inline-end:   2rem;
  }
  
  /* hide the scrollbar in WebKit browsers */
  .experience-row::-webkit-scrollbar {
    display: none;
  }

  /* card */
  .experience-card {
    flex:0 0 180px;
    scroll-snap-align:start;
    background:#fff;
    border-radius:0.75rem;
    box-shadow:0 12px 32px rgba(0,0,0,0.06);
    text-decoration:none;
    color:inherit;
    display:flex;
    flex-direction:column;
    transition:transform .2s ease;
  }
  .experience-card:hover { transform:translateY(-4px); }

  .experience-thumb {
    width:100%; height:130px;
    object-fit:cover;
    border-bottom:1px solid #eee;
  }

  .experience-card h3 {
    font-size:1rem;
    font-weight:600;
    margin:0.6rem 0 0;
    padding:0 0.8rem;
  }
  .experience-meta {
    font-size:0.8rem;
    color:#667;
    padding:0.2rem 0.8rem;
    margin-bottom:auto;
  }
  .experience-link {
    font-size:0.85rem;
    font-weight:600;
    color:#c89a2a;
    padding:0.6rem 0.8rem;
  }
  .experience-link:hover { text-decoration:underline; }

</style>
